import{d as O,m as _,T as C,g as F,a,u as e,w as d,F as X,o as Q,Z as Y,b as s,k as y,e as ee,t as p,n as $,f as P,h as te,q as B}from"./app-Bvi4oo79.js";import{_ as T}from"./ResetSaveButtons.vue_vue_type_script_setup_true_lang-BsP8jYhY.js";import{_ as h}from"./InputError.vue_vue_type_script_setup_true_lang-CVNr40G0.js";import{_ as b}from"./InputLabel.vue_vue_type_script_setup_true_lang-W2pR4QhM.js";import{_ as v}from"./Modal.vue_vue_type_script_setup_true_lang-Bdnk4ETl.js";import{_ as ae}from"./Select.vue_vue_type_script_setup_true_lang-Bu_DsJ47.js";import{_ as S}from"./TextInput.vue_vue_type_script_setup_true_lang-_zxVFMTy.js";import{_ as U}from"./Table.vue_vue_type_script_setup_true_lang-8r9q4G17.js";import{P as se}from"./ProductType-DHxMMxY3.js";import{_ as oe,d as V,r as re,f as g,W as D,b as le}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-BmktDnBJ.js";import{_ as ne}from"./Document.vue_vue_type_script_setup_true_lang-BfU33b64.js";import{_ as N}from"./DocumentText.vue_vue_type_script_setup_true_lang-Ckg6r2c-.js";import{_ as de}from"./PencilSquare.vue_vue_type_script_setup_true_lang-fhbYISJT.js";import{_ as ie}from"./Plus.vue_vue_type_script_setup_true_lang-Bz2GwK5h.js";import{_ as ue}from"./Trash.vue_vue_type_script_setup_true_lang-Bn02qA-B.js";import"./PrimaryButton-C07IvtWd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SecondaryButton.vue_vue_type_script_setup_true_lang-DnO6VNT1.js";import"./multiselect-Yf9tzmof.js";import"./ApplicationLogo-CQlkyxkR.js";const ce={class:"py-12"},pe={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},me={class:"bg-white shadow-sm sm:rounded-lg dark:bg-gray-800"},fe={class:"p-6 text-gray-900 dark:text-gray-100"},_e={class:"w-full flex gap-2"},ye={class:"flex gap-1.5"},he={class:"flex gap-1.5"},be=["onClick"],ve=["onClick"],ge=["onClick"],we={class:"flex gap-1.5"},xe=["onClick"],qe=["onClick"],je=["onClick"],ke={class:"border-b border-gray-100 dark:border-gray-700 px-3.5 p-3 text-xl font-medium"},Ce={class:"col-span-2 flex justify-end gap-3 my-2 pt-1 px-4"},$e={class:"border-b border-gray-100 dark:border-gray-700 px-3.5 p-3 text-xl font-medium"},Pe={class:"col-span-2 flex justify-end gap-3 my-2 pt-1 px-4"},Te={key:0,class:"text-gray-900 dark:text-gray-100"},Se={class:"flex gap-1.5"},Ve={class:"flex gap-1.5"},De={class:"flex gap-1.5"},Me={class:"border-b border-gray-100 dark:border-gray-700 px-3.5 p-3 text-xl font-medium"},et=O({__name:"Index",props:{dataTable:{},projects:{},projectWarehouse:{},showProjectsDataTable:{}},setup(R){const f=R,w=_(!1),K=()=>{w.value=!1},z=async l=>{await new Promise((o,t)=>{B.reload({data:{product_id:l},only:["showProjectsDataTable"],onSuccess:o,onError:t})}),w.value=!0},x=_(!1),q=_(!1),M=()=>{x.value=!1,i.reset()},E=()=>{q.value=!1,n.reset()},i=C({_method:"put",id:null,product_id:null,warehouse:null,quantity:null}),n=C({product_id:null,project_id:null,quantity:null,available_quantity:null,warehouse:null,quantities:null}),j=l=>{i.id=l.id,i.product_id=l.product_id,i.warehouse=l.warehouse,i.quantity=l.quantity,x.value=!0},I=async l=>{n.product_id=l.id,n.quantities=l.quantity,(!f.projects||!f.projectWarehouse)&&await new Promise((o,t)=>{B.reload({only:["projects","projectWarehouse"],onSuccess:o,onError:t})}),q.value=!0},L=l=>{var o;f.projectWarehouse&&(n.warehouse=f.projectWarehouse[l.value]??null,n.available_quantity=((o=n.quantities.find(t=>t.warehouse==n.warehouse))==null?void 0:o.quantity)??null)},Z=()=>new Promise((l,o)=>{i.post(route("products.update-quantity",i.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{l()},onError:()=>{o()}}),M()}),G=()=>new Promise((l,o)=>{n.post(route("products.add-to-project"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{l()},onError:()=>{o()}}),E()}),k=_(!1),c=C({id:null,name:null,created_at:null}),H=l=>{c.id=l.id,c.name=l.name,c.created_at=l.created_at,k.value=!0},W=()=>{k.value=!1,c.reset()},J=()=>{c.delete(route("products.destroy",c.id),{preserveScroll:!0}),W()};return(l,o)=>(Q(),F(X,null,[a(e(Y),{title:"Продукт"}),a(oe,null,{header:d(()=>o[6]||(o[6]=[s("h2",{class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"}," Продукт ",-1)])),default:d(()=>[s("div",ce,[s("div",pe,[s("div",me,[s("div",fe,[a(U,{"data-table":l.dataTable,"per-page-options":[5,10,15,20,50],"global-search":!0,"type-search":!0,"show-trashed":!0,"advanced-filters":!1},{additionalContent:d(()=>[s("div",_e,[a(e(y),{class:"w-full md:w-auto border border-gray-300 dark:border-gray-700 rounded-md px-5 py-1.5 active:scale-95 transition hover:bg-gray-50 dark:hover:bg-gray-800",href:l.route("products.create")},{default:d(()=>o[7]||(o[7]=[ee(" Създай Продукт ")])),_:1},8,["href"])])]),"cell(created_at)":d(({value:t,item:r})=>[s("div",ye,p(e(V)(t)),1)]),"cell(type)":d(({value:t,item:r})=>[s("div",he,p(e(re)(e(g)(e(se),t))),1)]),"cell(quantity_varna)":d(({value:t,item:r})=>{var u,m;return[s("div",{class:$(["cursor-pointer text-center rounded",{"bg-red-500 text-white":(((u=t[0])==null?void 0:u.quantity)??null)<r.minimum_quantity}]),onClick:A=>j(t[0]??null)},p(((m=t[0])==null?void 0:m.quantity)??""),11,be)]}),"cell(quantity_france)":d(({value:t,item:r})=>{var u,m;return[s("div",{class:$(["cursor-pointer text-center rounded",{"bg-red-500 text-white":(((u=t[0])==null?void 0:u.quantity)??null)<r.minimum_quantity}]),onClick:A=>j(t[0]??null)},p(((m=t[0])==null?void 0:m.quantity)??""),11,ve)]}),"cell(quantity_netherlands)":d(({value:t,item:r})=>{var u,m;return[s("div",{class:$(["cursor-pointer text-center rounded",{"bg-red-500 text-white":(((u=t[0])==null?void 0:u.quantity)??null)<r.minimum_quantity}]),onClick:A=>j(t[0]??null)},p(((m=t[0])==null?void 0:m.quantity)??""),11,ge)]}),"cell(action)":d(({value:t,item:r})=>[s("div",we,[a(e(y),{class:"border border-gray-300 dark:border-gray-700 rounded-md p-1 active:scale-90 transition",title:"Редактирай продукт",href:l.route("products.edit",r.id)},{default:d(()=>[a(de,{classes:"w-4 h-4 text-[#909090]"})]),_:2},1032,["href"]),a(e(y),{class:"border border-gray-300 dark:border-gray-700 rounded-md p-1 active:scale-90 transition",title:"Покажи продукт",href:l.route("products.show",r.id)},{default:d(()=>[a(N,{classes:"w-4 h-4 text-[#909090]"})]),_:2},1032,["href"]),s("button",{class:"border border-gray-300 dark:border-gray-700 rounded-md p-1 active:scale-90 transition",title:"Add to проект",onClick:u=>I(r)},[a(ie,{classes:"w-4 h-4 text-[#909090]"})],8,xe),s("button",{class:"border border-gray-300 dark:border-gray-700 rounded-md p-1 active:scale-90 transition",title:"Покажи products",onClick:u=>z(r.id)},[a(ne,{classes:"w-4 h-4 text-[#909090]"})],8,qe),s("button",{title:"Изтрий",class:"border border-gray-300 dark:border-gray-700 rounded-md p-1 active:scale-90 transition",onClick:u=>H(r)},[a(ue,{classes:"w-4 h-4 text-[#909090]"})],8,je)])]),_:1},8,["data-table"])])])])])]),_:1}),a(v,{show:x.value,"max-width":"lg",onClose:M},{default:d(()=>{var t,r;return[s("div",ke,[s("div",null,"Change quantity of product # "+p((t=e(i))==null?void 0:t.product_id),1)]),s("form",{class:"p-6",onSubmit:P(Z,["prevent"])},[s("div",null,[a(b,{for:"quantity",value:`Количество ${e(g)(e(D),(r=e(i))==null?void 0:r.warehouse)}`},null,8,["value"]),a(S,{id:"quantity",modelValue:e(i).quantity,"onUpdate:modelValue":o[0]||(o[0]=u=>e(i).quantity=u),type:"number",step:"1",class:"mt-1 block w-full"},null,8,["modelValue"]),a(h,{class:"mt-2",message:e(i).errors.quantity},null,8,["message"])]),s("div",Ce,[a(T,{processing:e(i).processing,"recently-successful":e(i).recentlySuccessful,onReset:o[1]||(o[1]=u=>e(i).reset())},null,8,["processing","recently-successful"])])],32)]}),_:1},8,["show"]),a(v,{show:q.value,"max-width":"lg",onClose:E},{default:d(()=>{var t;return[s("div",$e,[s("div",null,"Добави продукт №"+p((t=e(n))==null?void 0:t.product_id)+" към проект",1)]),s("form",{class:"p-6",onSubmit:P(G,["prevent"])},[s("div",null,[a(b,{for:"project",value:"Проект"}),a(ae,{modelValue:e(n).project_id,"onUpdate:modelValue":o[2]||(o[2]=r=>e(n).project_id=r),name:"project_id",options:l.projects,placeholder:"Проект",class:"mt-1 block w-full mb-3.5",onSelect:L},null,8,["modelValue","options"]),a(h,{class:"mt-2",message:e(n).errors.project_id},null,8,["message"])]),s("div",null,[a(b,{for:"available_quantity",value:`Налично количество в ${e(g)(e(D),e(n).warehouse)??"склада"}`},null,8,["value"]),a(S,{id:"quantity","model-value":e(n).available_quantity,type:"number",placeholder:"Налично количество",disabled:!0,class:"mt-1 block w-full mb-3.5"},null,8,["model-value"]),a(h,{class:"mt-2",message:e(n).errors.available_quantity},null,8,["message"])]),s("div",null,[a(b,{for:"quantity",value:`Количество да се добави към ${e(le)(f.projects,e(n).project_id)??"проект"}`},null,8,["value"]),a(S,{id:"quantity",modelValue:e(n).quantity,"onUpdate:modelValue":o[3]||(o[3]=r=>e(n).quantity=r),type:"number",placeholder:"Количество да се добави",step:"1",min:1,max:e(n).available_quantity,class:"mt-1 block w-full"},null,8,["modelValue","max"]),a(h,{class:"mt-2",message:e(n).errors.quantity},null,8,["message"])]),s("div",Pe,[a(T,{processing:e(i).processing,"recently-successful":e(i).recentlySuccessful,onReset:o[4]||(o[4]=r=>e(i).reset())},null,8,["processing","recently-successful"])])],32)]}),_:1},8,["show"]),a(v,{show:w.value,"max-width":"6xl",onClose:K},{default:d(()=>[o[8]||(o[8]=s("div",{class:"px-3.5 p-3 text-xl font-medium"}," Проекти ",-1)),l.showProjectsDataTable?(Q(),F("div",Te,[a(U,{"data-table":l.showProjectsDataTable,"per-page-options":[5,10,15,20,50],"global-search":!0,"advanced-filters":!1,"prop-name":"showProjectsDataTable"},{"cell(created_at)":d(({value:t,item:r})=>[s("div",Se,p(e(V)(t)),1)]),"cell(project.warehouse)":d(({value:t,item:r})=>[s("div",Ve,p(e(g)(e(D),r.project.warehouse)),1)]),"cell(action)":d(({value:t,item:r})=>[s("div",De,[a(e(y),{class:"border border-gray-300 dark:border-gray-700 rounded-md p-1 active:scale-90 transition",title:"Покажи проект",href:l.route("projects.show",r.project_id)},{default:d(()=>[a(N,{classes:"w-4 h-4 text-[#909090]"})]),_:2},1032,["href"])])]),_:1},8,["data-table"])])):te("",!0)]),_:1},8,["show"]),a(v,{show:k.value,onClose:W},{default:d(()=>{var t,r;return[s("div",Me," Delete проект "+p(((t=e(c))==null?void 0:t.name)??"")+" added on "+p(e(V)((r=e(c))==null?void 0:r.created_at))+" ? ",1),s("form",{class:"col-span-2 flex justify-end gap-3 my-2 pt-1 px-4",onSubmit:P(J,["prevent"])},[a(T,{processing:e(c).processing,"recently-successful":e(c).recentlySuccessful,"is-delete":!0,onReset:o[5]||(o[5]=u=>e(c).reset())},null,8,["processing","recently-successful"])],32)]}),_:1},8,["show"])],64))}});export{et as default};
