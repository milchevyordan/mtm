import{d as b,o as p,g as m,b as a,n as f,T as E,Q as g,a as l,u as t,w as i,F as $,Z as V,t as u,k as h,h as C,f as I}from"./app-DNzCrRZN.js";import{_ as S}from"./Accordion.vue_vue_type_script_setup_true_lang-DFxW5qM2.js";import{_ as N}from"./ResetSaveButtons.vue_vue_type_script_setup_true_lang-YRV1gGzj.js";import{_ as y}from"./InputError.vue_vue_type_script_setup_true_lang-D8oswhFt.js";import{_ as P}from"./InputLabel.vue_vue_type_script_setup_true_lang-CEVvSszl.js";import{_ as T}from"./Select.vue_vue_type_script_setup_true_lang-CijPz9Ej.js";import{_ as B}from"./TextInput.vue_vue_type_script_setup_true_lang-OgsLRRa5.js";import{_ as O}from"./Table.vue_vue_type_script_setup_true_lang-BCLJ4Lew.js";import{P as U}from"./ProductType-DHxMMxY3.js";import{W as x,_ as j,d as M,r as W,f as F}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-JRAjt2nF.js";import{_ as Z}from"./DocumentText.vue_vue_type_script_setup_true_lang-DCMvrWDE.js";import{_ as z}from"./PencilSquare.vue_vue_type_script_setup_true_lang-CAQ2lHp3.js";import{_ as D}from"./Plus.vue_vue_type_script_setup_true_lang-CGSa_VeO.js";import"./PrimaryButton-PQwFCoLq.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SecondaryButton.vue_vue_type_script_setup_true_lang-iIhSi5i1.js";import"./multiselect-CuXlu8jW.js";import"./ApplicationLogo-zYrl91-7.js";const H=b({__name:"Minus",props:{classes:{default:"w-6 h-6 flex-shrink-0"}},setup(w){return(e,_)=>(p(),m("svg",{fill:"currentColor",viewBox:"0 -960 960 960","stroke-width":"1.8",stroke:"currentColor",class:f(e.classes)},_[0]||(_[0]=[a("path",{d:"M200-450v-60h560v60H200Z"},null,-1)]),2))}}),K={class:"py-12"},L={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},Q={class:"relative rounded-lg shadow-sm bg-white dark:bg-gray-800 py-4 sm:py-6 px-4"},R={class:"text-gray-900 dark:text-gray-100"},A={class:"flex gap-1.5"},G={class:"flex gap-1.5"},J={class:"flex gap-1.5"},X=["onClick"],Y=["onClick"],ee={key:0,class:"flex-col gap-1.5 pt-2 min-w-[150px]"},te={class:"bg-white shadow-sm sm:rounded-lg dark:bg-gray-800 mt-4"},se={class:"p-6 text-gray-900 dark:text-gray-100"},re={class:"grid lg:grid-cols-1 xl:grid-cols-2 gap-4"},ve=b({__name:"Create",props:{dataTable:{}},setup(w){const e=E({id:null,warehouse:g().props.auth.user.warehouse!=x.Varna?g().props.auth.user.warehouse:null,products:[],productIds:[]}),_=async d=>new Promise((o,s)=>{e.post(route("product-requests.store"),{preserveScroll:!0,preserveState:!0,only:d,onSuccess:()=>{o()},onError:()=>{s(new Error("Error, during update"))}})}),v=d=>{const o={[d.id]:{product_id:d.id,quantity:null}};e.products={...e.products,...o},e.productIds.push(d.id)},k=d=>{const o=e.productIds.indexOf(d);e.products.hasOwnProperty(d)&&delete e.products[d],o!==-1&&e.productIds.splice(o,1)},q=Object.fromEntries(Object.entries(x).filter(([d])=>isNaN(Number(d))&&d!=="Varna"));return(d,o)=>(p(),m($,null,[l(t(V),{title:"Заявка"}),l(j,null,{header:i(()=>o[3]||(o[3]=[a("h2",{class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"}," Заявка ",-1)])),default:i(()=>[a("div",K,[a("div",L,[a("div",Q,[l(S,null,{head:i(()=>o[4]||(o[4]=[a("div",{class:"font-semibold text-xl sm:text-2xl mb-4 text-gray-900 dark:text-gray-100"}," Продукти ",-1)])),default:i(()=>[a("div",R,[l(O,{"data-table":d.dataTable,"per-page-options":[5,10,15,20,50],"global-search":!0,"advanced-filters":!1,"type-search":!0,"selected-row-indexes":t(e).productIds,"selected-row-column":"id"},{"cell(created_at)":i(({value:s,item:r})=>[a("div",A,u(t(M)(s)),1)]),"cell(type)":i(({value:s,item:r})=>[a("div",G,u(t(W)(t(F)(t(U),s))),1)]),"cell(quantity_varna)":i(({value:s,item:r})=>{var n,c;return[a("div",{class:f(["text-center rounded",{"bg-red-500 text-white":(((n=s[0])==null?void 0:n.quantity)??null)<r.minimum_quantity}])},u(((c=s[0])==null?void 0:c.quantity)??""),3)]}),"cell(quantity_france)":i(({value:s,item:r})=>{var n,c;return[a("div",{class:f(["text-center rounded",{"bg-red-500 text-white":(((n=s[0])==null?void 0:n.quantity)??null)<r.minimum_quantity}])},u(((c=s[0])==null?void 0:c.quantity)??""),3)]}),"cell(quantity_netherlands)":i(({value:s,item:r})=>{var n,c;return[a("div",{class:f(["text-center rounded",{"bg-red-500 text-white":(((n=s[0])==null?void 0:n.quantity)??null)<r.minimum_quantity}])},u(((c=s[0])==null?void 0:c.quantity)??""),3)]}),"cell(action)":i(({value:s,item:r})=>[a("div",J,[t(e).productIds.includes(r.id)?(p(),m("button",{key:0,class:"border border-[#E9E7E7] dark:border-gray-700 rounded-md p-1 active:scale-90 transition",title:"Премахни от заявка",onClick:n=>k(r.id)},[l(H,{classes:"w-4 h-4 text-[#909090]"})],8,X)):(p(),m("button",{key:1,class:"border border-[#E9E7E7] dark:border-gray-700 rounded-md p-1 active:scale-90 transition",title:"Добави към заявка",onClick:n=>v(r)},[l(D,{classes:"w-4 h-4 text-[#909090]"})],8,Y)),l(t(h),{class:"border border-[#E9E7E7] dark:border-gray-700 rounded-md p-1 active:scale-90 transition",title:"Редактирай продукт",href:d.route("products.edit",r.id)},{default:i(()=>[l(z,{classes:"w-4 h-4 text-[#909090]"})]),_:2},1032,["href"]),l(t(h),{class:"border border-gray-300 dark:border-gray-700 rounded-md p-1 active:scale-90 transition",title:"Покажи продукт",href:d.route("products.show",r.id)},{default:i(()=>[l(Z,{classes:"w-4 h-4 text-[#909090]"})]),_:2},1032,["href"])]),t(e).productIds.includes(r.id)?(p(),m("div",ee,[l(B,{id:"quantities_"+r.id,modelValue:t(e).products[r.id].quantity,"onUpdate:modelValue":n=>t(e).products[r.id].quantity=n,type:"number",placeholder:"Количество",step:"1",class:"block w-full"},null,8,["id","modelValue","onUpdate:modelValue"]),l(y,{class:"mt-2",message:t(e).errors["products."+r.id+".quantity"]},null,8,["message"])])):C("",!0)]),_:1},8,["data-table","selected-row-indexes"])])]),_:1})]),a("div",te,[a("div",se,[a("div",re,[a("form",{class:"mt-6 space-y-6",onSubmit:o[2]||(o[2]=I(s=>_(),["prevent"]))},[a("div",null,[l(P,{for:"warehouse",value:"За Склад"}),l(T,{id:"warehouse",modelValue:t(e).warehouse,"onUpdate:modelValue":o[0]||(o[0]=s=>t(e).warehouse=s),name:"warehouse",options:t(q),placeholder:"за кой склад",class:"mt-1 block w-full mb-3.5"},null,8,["modelValue","options"]),l(y,{class:"mt-2",message:t(e).errors.warehouse},null,8,["message"])]),l(N,{processing:t(e).processing,"recently-successful":t(e).recentlySuccessful,onReset:o[1]||(o[1]=s=>t(e).reset())},null,8,["processing","recently-successful"])],32)])])])])])]),_:1})],64))}});export{ve as default};
